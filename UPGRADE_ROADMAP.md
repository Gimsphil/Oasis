# 오아시스 (OASIS) 업그레이드 로드맵

> **참고 문서**: egManual.pdf (산출기본 p137~201, 산출응용 p203~365, 일위대가 p585~621)
> **작성일**: 2026-02-11
> **프로젝트**: D:\오아시스\SANCHUL_Sheet_1

---

## 📋 목차

1. [개요](#1-개요)
2. [Phase 1: 핵심 산출 기능 강화](#phase-1---핵심-산출-기능-강화) ✅ 완료
3. [Phase 2: 산출 효율화 기능](#phase-2---산출-효율화-기능) ✅ 완료
4. [Phase 3: 집계/관리 기능](#phase-3---집계관리-기능) ✅ 완료
5. [Phase 4: 출력/변환 기능](#phase-4---출력변환-기능) ✅ 완료
6. [Phase 5: 고급 기능](#phase-5---고급-기능) ✅ 완료
7. [Phase 6: 전문 기능](#phase-6---전문-기능) ✅ 완료
8. [변경 이력](#변경-이력)

---

## 1. 개요

### 1.1 현재 상태 요약

| 항목 | 내용 |
|------|------|
| **앱 버전** | 1.0.0 → 1.1.0 (업그레이드 완료) |
| **프레임워크** | PyQt6 |
| **Python** | 3.14 |
| **코드 라인** | 약 10,182 + 500 = 10,682 줄 |
| **의존성** | PyQt6, pandas, numpy, openpyxl, xlrd |

### 1.2 업그레이드 현황

```
✅ Phase 1: 핵심 산출 기능 (4/4) - 2026-02-11 완료
✅ Phase 2: 산출 효율화 (4/4) - 2026-02-11 완료
✅ Phase 3: 집계/관리 (2/2) - 2026-02-11 완료
✅ Phase 4: 출력/변환 (3/3) - 2026-02-11 완료
✅ Phase 5: 고급 기능 (3/3) - 2026-02-11 완료
✅ Phase 6: 전문 기능 (2/2) - 2026-02-11 완료
```

---

## Phase 1: 핵심 산출 기능 강화 ✅ 완료

**완료일**: 2026-02-11

| 순서 | 기능 | 상태 | 파일 |
|------|------|------|------|
| 1-1 | 산출수식 문자 포함 안전 파서 | ✅ | `utils/formula_parser.py` |
| 1-2 | Enter 연속입력 (40byte 자동줄추가) | ✅ | `managers/event_filter.py` |
| 1-3 | Ctrl+C/V/X 셀 복사/붙이기 | ✅ | `event_filter.py`, `output_detail_tab.py` |
| 1-4 | F4 수량 없이 입력 (1@) | ✅ | `managers/event_filter.py` |

---

## Phase 2: 산출 효율화 기능 ✅ 완료

**완료일**: 2026-02-11

| 순서 | 기능 | 상태 | 파일 |
|------|------|------|------|
| 2-1 | $H/$L 변수 대입 | ✅ | `utils/formula_parser.py` |
| 2-2 | 수작업 자재 입력 (;) | ✅ | `utils/formula_parser.py` |
| 2-3 | 구간접속 자동 산출 | ✅ | `core/section_connection.py` |
| 2-4 | 기초작업 템플릿 | ✅ | `data/templates/basic_work.json` |

---

## Phase 3: 집계/관리 기능 ✅ 완료

**완료일**: 2026-02-11

| 순서 | 기능 | 상태 | 파일 |
|------|------|------|------|
| 3-1 | 소요자재 집계 | ✅ | `popups/material_summary_popup.py` |
| 3-2 | 일괄 변경 도구 | ✅ | `popups/batch_tools_popup.py` |

---

## Phase 4: 출력/변환 기능 ✅ 완료

**완료일**: 2026-02-11

| 순서 | 기능 | 상태 | 파일 |
|------|------|------|------|
| 4-1 | 산출→견적 변환 | ✅ | `core/estimate_converter.py`, `popups/estimate_options_popup.py` |
| 4-2 | 엑셀 변환 | ✅ | `core/excel_exporter.py` |
| 4-3 | 산식오류 검사 | ✅ | `core/formula_checker.py`, `popups/formula_check_popup.py` |

### 4-1. 산출→견적 변환 (내역작성)

**옵션**
| 옵션 | 설명 |
|------|------|
| 재료할증 | (%) 자동 가산 |
| 수량 소수점 | 정수/1자리/2자리 |
| 1:1 층별 | 공종별 작성 |
| 단가 재사용 | 이전 단가 유지 |

### 4-2. 엑셀 변환

**옵션**
| 옵션 | 설명 |
|------|------|
| 시트 구성 | 총괄표 + 공종별 내역서 |
| 서식 | 헤더 스타일, 테두리, 숫자 형식 |
| 산출일위대 | 들여쓰기 표시 |

### 4-3. 산식오류 검사

**검사 항목**
- 괄호 짝 검사
- 연속 연산자
- 빈 괄호
- 잘못된 문자열

---

## Phase 5: 고급 기능 ✅ 완료

**완료일**: 2026-02-11

| 순서 | 기능 | 상태 | 파일 |
|------|------|------|------|
| 5-1 | 산출판 시스템 | ✅ | `popups/output_board_popup.py` |
| 5-2 | 간선 산출판 | ✅ | `popups/cable_routing_popup.py` |
| 5-3 | 설계변경 | ✅ | `popups/design_change_popup.py` |

### 5-1. 산출판 시스템

**기능**:
- 산출내역 시각적 판서 형식으로 변환
- 항목별 그룹화 및 정렬 (공종별, 규격별, 수량순)
- 검색 및 필터 기능
- 인쇄 및 내보내기 지원

### 5-2. 간선 산출판

**기능**:
- 케이블/전선 간선 경로별 정리
- 트리 구조로 간선 경로 표시
- 케이블 유형 필터 (전력, 통신, 접지)
- 회로별 상세내역 표시

### 5-3. 설계변경

**기능**:
- 변경 대상 선택 (체크박스, 필터, 검색)
- 변경 유형: 수량 일괄 변경, 규격 변경, 수량 증감률
- 변경 사유 입력
- 변경 미리보기 (현재↔변경후 비교)
- 변경 이력 관리 (변경 취소Undo 지원)

---

## Phase 6: 전문 기능 ✅ 완료

**완료일**: 2026-02-11

| 순서 | 기능 | 상태 | 파일 |
|------|------|------|------|
| 6-1 | 그림산출 | ✅ | `popups/graphic_output_popup.py` |
| 6-2 | AutoCAD 연동 | ✅ | `core/cad_integration.py` |

### 6-1. 그림산출

**파일**: `popups/graphic_output_popup.py`

**기능**:
- 도면 이미지/DXF 파일 표시
- 산출 항목 도면 상에서 선택 및 마킹
- 점/영역/선 추가 모드
- 도면 항목과 산출 항목 매핑
- 레이어별 추출 및 자동 산출
- 추출 항목 목록 관리
- 메뉴 바 및 인쇄/내보내기 지원

### 6-2. AutoCAD 연동

**파일**: `core/cad_integration.py`

**의존성**: `ezdxf` (pip install ezdxf), `comtypes` (Windows)

**기능**:
- DXF/DWG 파일 열기 지원
- 레이어별 객체 정보 추출
- 객체 유형별 분류 (선/면/점)
- 길이/면적 자동 계산
- 산출 항목 자동 생성 (레이어 매핑 기반)
- 레이어별 요약 정보 제공

---

## 📅 전체 일정표

```
┌─────────────────────────────────────────────────────────────┐
│ Phase 1: 핵심 산출 기능 (2.5시간) ✅ 완료                   │
│ Phase 2: 효율화 기능 (3.5시간) ✅ 완료                     │
│ Phase 3: 집계/관리 (4시간) ✅ 완료                         │
│ Phase 4: 출력/변환 (5.5시간) ✅ 완료                       │
│ Phase 5: 고급 기능 (6시간+) ✅ 완료                        │
│ Phase 6: 전문 기능 (8시간+) ✅ 완료                       │
└─────────────────────────────────────────────────────────────┘
```

---

## 🔧 검증 절차

각 Phase 완료 후:

1. **구문 검사**
   ```bash
   python -m py_compile <파일>
   ```

2. **기능 테스트**
   - 해당 기능의 시나리오 테스트
   - 기존 기능 회선 테스트

3. **로그 업데이트**
   - `SYSTEM_LOG.md`에 Phase 완료 기록

---

## 📁 관련 문서

| 문서 | 설명 |
|------|------|
| `설명서/egManual.pdf` | 원본 매뉴얼 (709페이지) |
| `설명서/implementation_plan.md` | 구현 현황 상세 분석 |
| `설명서/phase_prompts.md` | 각 단계별 상세 프롬프트 |
| `README.md` | 프로젝트 개요 |
| `SYSTEM_LOG.md` | 시스템 변경 이력 |
| `UPGRADE_ROADMAP.md` | 이 파일 |

---

## 변경 이력

| 날짜 | 버전 | 내용 | 작성자 |
|------|------|------|--------|
| 2026-02-11 | 1.4.0 | Phase 6 완료: 전문 기능 (그림산출, AutoCAD 연동) | Sisyphus |
| 2026-02-11 | 1.3.0 | Phase 5 완료: 고급 기능 (산출판, 간선산출판, 설계변경) | Sisyphus |
| 2026-02-11 | 1.2.0 | Phase 4 완료: 출력/변환 기능 (견적변환, 엑셀내보내기, 산식검사) | Sisyphus |
| 2026-02-11 | 1.1.0 | Phase 1~3 완료: 핵심 산출, 효율화, 집계/관리 | Sisyphus |
| 2026-02-10 | 1.0.0 | 초기 버전 | - |
